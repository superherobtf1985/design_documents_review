# ER図2-Q1

## 全体
- ActiveRecordでデフォルトで作られる登録日、更新日の記述もお願いいたします。
もし持たないのであれば理由を教えてください。
- ユーザの登録住所以外にも、配送先を複数持てるようにしてほしいです。
（amazonのような形式が理想です）
- 要件に「入荷履歴を表示できること（入荷した日時、入荷した商品、個数）」がありますが、
どのように実現しますか。

## 管理人
- 管理者テーブルとエンドユーザー、商品テーブルにリレーションがありますが、理由はありますか。

## エンドユーザー
-  エンドユーザが退会した場合、該当のレコードはどうなりますか。

## 商品
- アーティスト名、レーベル名、ジャンル等は画面でベタ打ちですか？
表記揺れが起こらないような設計にできるとbetterです。
- 曲カラムがありますが、同一カラムに複数の曲名を入れるということでしょうか？
1曲だけ曲名を変更したい・1曲だけ削除したい、など、後からデータを変更する際に不便になります。
複数ディスク、曲順などの管理も難しくなります。
ユーザー側に表示するときにデザインも当てづらくなります。
カリキュラム「チーム開発の手引き」＞「設計」＞データベース設計スライドの29枚目以降を再確
認してください。
- 発売日はどのように管理しますか。
- 在庫数カラムがありますが、商品が入荷するたびに数値を変更するのでしょうか。
例えば現在の在庫が100個あって、入荷が350個あった場合、在庫数を450と入力する運用だとすると
計算ミスを誘発しやすく、実際の在庫数とデータベース上の在庫数に差が生まれやすい構造となります。
入荷したタイミングで入荷数を入れられるようにすれば楽です。
運営上、「いつ、どの商品が入荷したか」という情報を管理しておく方が安全な運用です。
　- 入荷数の証拠にもなります。
- 複数枚組のCDは登録できますか？
（1枚目の1曲目と2枚目の1曲目の区別はつけられますか？）
- 「ステータス」は何のステータスかを記載するようにしましょう。
- 複数曲はどのように管理しますか？

## カート
- ジャケット画像やアーティスト名は商品とリレーションがあるため、カートのカラムとしては不要です。
- カート内の商品は顧客ごとに異なりますが、どのように判断しますか？
- カートテーブルという命名ですが、表現されているのは「カートの中身」かと思います。
カートは一つ、その中に入っている商品は複数、というイメージかと思いますので、
テーブル名を「カートアイテム」「カート内商品」のような命名にすると良いかと思います。
- PKが注文IDになっていますが、テーブル名と一致していません。

## 決済
- テーブル名は、「受注」「注文」のような命名にしましょう。
    - データベースの情報は管理者が利用します。管理者側のアクションにしておきましょう。
- 配送先の郵便番号や氏名はどのように管理しますか？
- 合計金額は注文明細のデータを計算すれば算出できる値ですが、証跡として計算結果を残しておくことが多いです（計算できる値は原則DBに持ちませんが、お金のことは細心の注意が必要です）
「顧客に請求した金額と、その内訳を店側で説明できるようにしておく」必要があります。
- 送料が変更された場合、購入時の送料はいくらだったか確認できますか。
- 消費税はどこで管理しますか？
- 決済後はカート内にデータは残りません。カート情報を購入後も持つ必要はないためカートidというFKは不要です。
- 購入日カラムは「作成日(created_at)」で実現できるかと思いますので、必須ではありません。

## 購入履歴
- PKの記述をお願いします。
- 発送状況は、1会計で購入した商品全て同じステータスになりませんか？
このテーブルに置いてある理由があれば教えてください。
    - [check]細かくて恐縮ですが、「なりませんか？」より「なるかと思います」の方が与える印象は柔らかくなります。
      受講生も実装に入りたくてウズウズしているフェーズなので、なるべく柔らかい言い回しで刺激を減らすことを心がけてみましょう。(マストではありませんが)
- 購入した数量や購入時価格はどこで管理しますか？

# ER図2-Q2
## 全体
- 購入時に指定した配送先はどこで確認できますか。
    - [check]配送先テーブルがない理由として、こちらは適切ではありません。
      購入時に指定した配送先は、注文履歴テーブルで確認できます。
      別の理由があったはずですので、再考し、修正をお願いします。

## エンドユーザー
- 姓名の「名」を入力するカラムがありません。追加をお願いします。

## 商品
- 1つの商品は複数ディスクを持てます。リレーションはどうなりますか？
- ディスクテーブルのデータから算出できるデータかと思いますが、
このカラムを持っている理由はありますか？
- 発売日はどのように管理しますか。
- 在庫数カラムがありますが、商品が入荷するたびに数値を変更するのでしょうか。
例えば現在の在庫が100個あって、入荷が350個あった場合、在庫数を450と入力する運用だとすると
計算ミスを誘発しやすく、実際の在庫数とデータベース上の在庫数に差が生まれやすい構造となります。
入荷したタイミングで入荷数を入れられるようにすれば楽です。
運営上、「いつ、どの商品が入荷したか」という情報を管理しておく方が安全な運用です。
　- 入荷数の証拠にもなります。
 
## ディスク
- 1枚のディスクは複数曲を持てます。リレーションはどうなりますか？
- 一般的にトラックNoは曲順を管理するものです。命名の変更をお願いします。

## 曲名
- 曲順はどのように管理しますか？

## カートアイテム
- PKが存在しません。追加をお願いします。
- 1商品につき何枚カートに入れているかはどのように保持しますか？
- 商品のリレーションから値段は取得でき、小計は計算できるため、小計金額カラムは不要になります。削除をお願いします。

## 購入
- テーブル名は、「受注」「注文」のような命名にしましょう。
    - データベースの情報は管理者が利用します。管理者側のアクションにしておきましょう。
- created_atと同日になるかと思いますが、別で持った理由はありますか。
（間違いではないので、理由があれば知りたいです）
- 配送状況はどこで管理しますか？

## 購入詳細
- テーブル名は、「受注」「注文」のような命名にしましょう。
- 何を購入したか判別できますか。
- 購入(受注)と購入詳細(受注詳細)のリレーションの関係は正しいですか？

## 管理者
- 管理者テーブルとエンドユーザー、商品テーブルにリレーションがありますが、理由はありますか。

## ジャンル・レーベル
- 「ジャンル」「レーベル」テーブルに対して「ジャンル」「レーベル」というカラムがありますが、属性とエンティティが同名になっていては、何を指しているのか分かりません。
  - 「名前」を表示したいので、命名をみなしましょう。

